(this.webpackJsonpminefields=this.webpackJsonpminefields||[]).push([[0],{65:function(e,n,t){e.exports=t(75)},74:function(e,n,t){},75:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),o=t(59),l=t.n(o),s=t(63),i=t(38),c=t(42),u=t(41),f=t(40),m=(t(74),t(78)),d=t(77),p=t(64),v=t(79);var E={rows:10,cols:10,mines:10},w=function(e){var n=e.rows,t=e.cols;return m.a(0,n).map((function(){return m.a(0,t).fill(0)}))},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,n=e.rows,t=e.cols,a=e.mines,r={options:{rows:n,cols:t,mines:a},started:null,stopped:null,minesLeft:a,_cellsLeft:n*t-a};return r._values=w(r.options),r.field=r._values.map((function(e){return e.map((function(){return"closed"}))})),r},g=function e(n,t){var a=t.row,r=t.col;if(n.stopped)return n;var o=n._values;n.started||function(e,n,t,a){var r=n.rows,o=n.cols,l=n.mines;for(;l;){var s=Math.floor(Math.random()*r),i=Math.floor(Math.random()*o);e[s][i]||s===t||i===a||(e[s][i]="mine",l--,N(s,i,r,o,(function(n,t){"number"===typeof e[n][t]&&e[n][t]++})))}}(o=w(n.options),n.options,a,r);var l=n.field[a][r];if("closed"!==l&&"question"!==l)return n;var s=o[a][r],i=d.a(n,{field:p.a(a,v.a(r,s),n.field),started:n.started||Date.now(),_cellsLeft:n._cellsLeft-1,_values:o});if(0===s){var c=n.options;N(a,r,c.rows,c.cols,(function(n,t){i=e(i,{row:n,col:t})}))}else"mine"===s?(i.won=!1,i.stopped=Date.now()):0===i._cellsLeft&&(i.won=!0,i.stopped=Date.now());return d.a(n,i)},h=function(e,n){var t=n.row,a=n.col;if(e.stopped)return e;var r=p.a(t,p.a(a,(function(e){switch(e){case"closed":return"flag";case"flag":return"question";case"question":return"closed";default:return e}})),e.field),o="flag"===r[t][a]?-1:"flag"===e.field[t][a]?1:0,l=e.minesLeft+o;return d.a(e,{field:r,minesLeft:l})},_=function(e){return d.a(e,{field:e.field.map((function(n,t){return n.map((function(n,a){var r=e._values[t][a];return"flag"===n&&"mine"!==r?"mine-wrong":r}))}))})};function N(e,n,t,a,r){for(var o=-1;o<2;o++)for(var l=-1;l<2;l++){var s=e+o,i=n+l;s>=0&&s<t&&i>=0&&i<a&&(s!==e||i!==n)&&r(s,i)}}var x=function(e){var n=e.children,t=e.onClose;return r.a.createElement("div",{className:"messagebox"},r.a.createElement("div",{className:"messagebox__content"},n),r.a.createElement("div",{className:"messagebox__footer"},r.a.createElement("button",{onClick:t},"OK")))},C=function(e){var n=e.started,t=e.stopped,a=f.useUpdate();r.a.useEffect((function(){if(n&&!t){var e=setInterval(a,1e3);return function(){return clearInterval(e)}}}),[n,t]);var o=n?function(e){var n=(~~e%60).toString(),t=(~~(e/60)%60).toString(),a=(~~(e/3600)).toString(),r=(1===n.length?"0":"")+n;return["0"===a?"":a,"0"===t?"":(1===t.length?"0":"")+t,r].filter(Boolean).join(":")}(((t||Date.now())-n)/1e3):"-";return r.a.createElement("span",null,"Time: ",o)},L=function(e){var n=e.onChange,t=r.a.useState((function(){var e="This value is required";return u.b({rows:u.a().required(e).min(10).max(30),cols:u.a().required(e).min(10).max(30),mines:u.a().required(e).min(10).max(100).test("mines","Too much mines",(function(){var e=this.parent;return e.mines/(e.rows*e.cols)<.3}))})})),a=Object(i.a)(t,1)[0],o=function(e,n){return r.a.createElement("div",{className:"field"},r.a.createElement("label",null,r.a.createElement("span",{className:"field__label"},n),r.a.createElement(c.b,{name:e,type:"number"})),r.a.createElement(c.a,{name:e,component:"div",className:"field__error"}))};return r.a.createElement(c.d,{initialValues:E,validationSchema:a,onSubmit:n},(function(){return r.a.createElement(c.c,{className:"game-options"},o("rows","Rows:"),o("cols","Columns:"),o("mines","Mines:"),r.a.createElement("button",{type:"submit",className:"new-game"},"New game!"))}))};l.a.render(r.a.createElement((function(){var e=r.a.useState(),n=Object(i.a)(e,2),t=n[0],a=n[1],o=Object(f.useLogic)((function(){return{reset:function(e){return function(){return b(e)}},open:function(e,n){return function(t){return g(t,{row:e,col:n})}},mark:function(e,n){return function(t){return h(t,{row:e,col:n})}},revealAll:function(){return _}}}),b),l=Object(i.a)(o,2),c=l[0],u=l[1];r.a.useEffect((function(){return u.reset(t)}),[t,u]);var m=r.a.useState(),d=Object(i.a)(m,2),p=d[0],v=d[1];return r.a.useEffect((function(){c.stopped&&v(!0)}),[c.stopped]),f.useEffectPrevious((function(e){var n=Object(i.a)(e,1)[0];c.stopped&&!p&&n&&u.revealAll()}),[p,c.stopped]),r.a.createElement("div",null,r.a.createElement(L,{onChange:function(e){a(Object(s.a)({},e)),v(!1)}}),r.a.createElement("hr",null),r.a.createElement("div",{className:"wrap-1"},r.a.createElement("div",{className:"wrap-2"},r.a.createElement("div",null,r.a.createElement("div",{className:"game-stats"},r.a.createElement(C,{started:c.started,stopped:c.stopped}),r.a.createElement("span",null,"Mines: ",c.minesLeft)),r.a.createElement("div",{className:"game-field"},r.a.createElement("table",{onContextMenu:function(e){return e.preventDefault()}},r.a.createElement("tbody",null,c.field.map((function(e,n){return r.a.createElement("tr",{key:n},e.map((function(e,t){return r.a.createElement("td",{key:t,className:"cell-".concat(e),onClick:function(){return u.open(n,t)},onContextMenu:function(){return u.mark(n,t)}},e)})))})))))))),p&&r.a.createElement(x,{onClose:function(){return v(!1)}},c.won?"You win!":"You lose!"))}),null),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.d6e51338.chunk.js.map